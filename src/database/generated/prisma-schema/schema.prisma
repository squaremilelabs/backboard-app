//////////////////////////////////////////////////////////////////////////////////////////////
// DO NOT MODIFY THIS FILE                                                                  //
// This file is automatically generated by ZenStack CLI and should not be manually updated. //
//////////////////////////////////////////////////////////////////////////////////////////////

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum TopicStatus {
  FUTURE
  TABLED
  CURRENT
  CLOSED
  CANCELED
  MERGED
  FORKED

  @@map("TOPIC_STATUS")
}

enum TaskStatus {
  DRAFT
  TO_DO
  BLOCKED
  DONE
  CANCELED

  @@map("TASK_STATUS")
}

model User {
  id                    String              @id()
  created_at            DateTime            @default(now()) @db.Timestamptz()
  name                  String
  email                 String              @unique()
  associated_as_persons Person[]            @relation("associated_as_persons")
  persons               Person[]            @relation("created_persons")
  topics                Topic[]
  topic_notes           TopicNote[]
  tasks                 Task[]
  task_checklist_items  TaskChecklistItem[]

  @@map("users")
}

model Person {
  id                 String   @id() @default(cuid())
  created_at         DateTime @default(now()) @db.Timestamptz()
  created_by_id      String
  created_by         User     @relation("created_persons", fields: [created_by_id], references: [id])
  name               String
  topics             Topic[]
  tasks              Task[]
  associated_user_id String?
  associated_user    User?    @relation("associated_as_persons", fields: [associated_user_id], references: [id])

  @@unique([created_by_id, name])
  @@map("persons")
}

model Topic {
  id            String      @id() @default(cuid())
  created_at    DateTime    @default(now()) @db.Timestamptz()
  created_by_id String
  created_by    User        @relation(fields: [created_by_id], references: [id])
  title         String
  description   String?
  status        TopicStatus @default(FUTURE)
  notes         TopicNote[]
  persons       Person[]
  tasks         Task[]

  @@map("topics")
}

model TopicNote {
  id            String   @id() @default(cuid())
  created_at    DateTime @default(now()) @db.Timestamptz()
  created_by_id String
  created_by    User     @relation(fields: [created_by_id], references: [id])
  topic_id      String
  topic         Topic    @relation(fields: [topic_id], references: [id])
  content       String?
  is_archived   Boolean  @default(false)

  @@map("topic_notes")
}

model Task {
  id              String              @id() @default(cuid())
  created_at      DateTime            @default(now()) @db.Timestamptz()
  created_by_id   String
  created_by      User                @relation(fields: [created_by_id], references: [id])
  title           String
  description     String?
  status          TaskStatus          @default(DRAFT)
  date            DateTime?           @db.Date()
  size_minutes    Int?
  checklist_items TaskChecklistItem[]
  doer_id         String?
  doer            Person?             @relation(fields: [doer_id], references: [id])
  topics          Topic[]

  @@map("tasks")
}

model TaskChecklistItem {
  id            String   @id() @default(cuid())
  created_at    DateTime @default(now()) @db.Timestamptz()
  created_by_id String
  created_by    User     @relation(fields: [created_by_id], references: [id])
  task_id       String
  task          Task     @relation(fields: [task_id], references: [id])
  order         Int
  text          String
  is_checked    Boolean  @default(false)

  @@unique([task_id, order])
  @@map("task_checklist_items")
}
